{"version":3,"sources":["../../src/pages/add-data/add-data.module.ts","../../src/pages/add-data/add-data.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AddDataPage } from './add-data';\n\n@NgModule({\n  declarations: [\n    AddDataPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(AddDataPage),\n  ],\n})\nexport class AddDataPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-data/add-data.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavParams, ViewController, LoadingController, ToastController, AlertController } from 'ionic-angular';\nimport { HttpClient } from '@angular/common/http';\nimport { Camera, CameraOptions } from '@ionic-native/camera';\nimport { FormBuilder, FormGroup, FormControl, Validators } from '@angular/forms';\nimport { FileTransfer, FileUploadOptions, FileTransferObject } from '@ionic-native/file-transfer';\nimport { ShareService } from '../../providers/service/share';\n\n@IonicPage()\n@Component({\n  selector: 'page-add-data',\n  templateUrl: 'add-data.html',\n})\nexport class AddDataPage {\n  public pos: any;\n  public usrData: any;\n\n  public reportForm : FormGroup;\n  public title : FormControl;\n  public descpt : FormControl;\n  //public fname : FormControl;\n  public imageURI:any;\n  public imageFileName:any;\n\n  constructor(\n    private transfer: FileTransfer,\n    public fb : FormBuilder,  \n    private camera : Camera, \n    public navParams: NavParams, \n    private loadingCtrl : LoadingController,\n    private alertCtrl: AlertController,\n    public toastCtrl: ToastController,\n    public view: ViewController,\n    public http: HttpClient,\n    public shareService: ShareService\n  ) {    \n    this.pos = navParams.get('pos');\n    this.title = fb.control('', Validators.required);\n    this.descpt = fb.control('', Validators.required);\n    this.usrData = this.shareService.getUserData();\n    //this.fname = fb.control('', Validators.required);\n    this.reportForm = fb.group({\n      'title': this.title, \n      'descpt': this.descpt, \n      //'fname': this.fname\n    })\n  }\n\n  ionViewDidLoad() {\n    // Receiving data via Service\n    //this.usrData = this.shareService.getUserData();\n    //console.log(this.usrData);\n    //console.log(this.pos.lng);\n  }\n\n  takePicture() {\n    const imgCam: CameraOptions={\n      quality: 50,\n      destinationType: this.camera.DestinationType.FILE_URI,\n      sourceType: this.camera.PictureSourceType.CAMERA,\n      encodingType: this.camera.EncodingType.JPEG\n    }\n    \n    this.camera.getPicture(imgCam).then((imageData) => {\n        this.imageURI = imageData;\n        this.imageFileName=imageData.substr(imageData.lastIndexOf('/') + 1);\n      }, (err) => {\n        console.log(err);\n      });\n  }\n\n  submit() {\n    let loader = this.loadingCtrl.create({content: \"กำลังบันทึกข้อมูล..\"});    \n    let title = this.reportForm.controls['title'].value;\n    let descpt = this.reportForm.controls['descpt'].value;\n    let lat = this.pos.lat;\n    let lon = this.pos.lng;\n    let img64 = this.imageFileName;\n    let usrId = this.usrData.id_user;\n    let usrEmail = this.usrData.email_user;\n\n    let data = JSON.stringify({\n      'lat':lat,\n      'lon':lon,\n      'title':title,\n      'descpt':descpt,\n      'usrId':usrId,\n      'usrEmail': usrEmail,\n      'img64':img64\n    });\n    \n    loader.present();    \n    this.http.post('http://119.59.125.189/service/isnre_report.php', data)\n    .subscribe(res => {\n      loader.dismiss();\n    }, error => {\n      console.log(\"Oooops!\");\n      loader.dismiss();\n    });\n\n    //upload image\n    const fileTransfer: FileTransferObject = this.transfer.create();\n    let options: FileUploadOptions = {\n      fileKey: 'file',\n      fileName: this.imageFileName,      \n      chunkedMode: false,\n      mimeType: \"image/jpeg\",\n      headers: {}\n    }\n  \n    fileTransfer.upload(this.imageURI, 'http://119.59.125.189/service/isnre_upload.php', options)\n    .then(res => {   \n      loader.dismiss(); \n      this.closeModal();      \n      let alert=this.alertCtrl.create({\n        title: 'ส่งข้อมูลสำเร็จ!',\n        subTitle: 'ข้อมูลของคุณถูกส่งเข้าสู่ระบบเรียบร้อยแล้ว',\n        buttons:['ok']\n      });\n      alert.present();     \n      //this.presentToast(\"Image uploaded successfully\");\n    }, (err) => {\n      loader.dismiss();\n      this.presentToast(err);\n    });\n  }  \n  \n  presentToast(msg) {\n      let toast = this.toastCtrl.create({\n        message: msg,\n        duration: 6000,\n        position: 'bottom'\n      });  \n      toast.onDidDismiss(() => {\n        console.log('Dismissed toast');\n      });  \n      toast.present();\n  } \n  \n  closeModal() {\n    this.view.dismiss();\n    //this.navCtrl.setRoot(MapPage, this.dat)\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-data/add-data.ts"],"sourceRoot":""}