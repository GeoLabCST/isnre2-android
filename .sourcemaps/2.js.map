{"version":3,"sources":["../../src/pages/add-data/add-data.module.ts","../../src/pages/add-data/add-data.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACP;AAUzC;IAAA;IAAgC,CAAC;IAApB,iBAAiB;QAR7B,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,8DAAW;aACZ;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,8DAAW,CAAC;aACtC;SACF,CAAC;OACW,iBAAiB,CAAG;IAAD,wBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;ACZY;AACqE;AAC7D;AACW;AACoB;AACiB;AAOlG;IAUE,qBACU,QAAsB,EACvB,EAAgB,EACf,MAAe,EAChB,SAAoB,EACnB,WAA+B,EAC/B,SAA0B,EAC3B,SAA0B,EAC1B,IAAoB,EACpB,IAAgB;QARf,aAAQ,GAAR,QAAQ,CAAc;QACvB,OAAE,GAAF,EAAE,CAAc;QACf,WAAM,GAAN,MAAM,CAAS;QAChB,cAAS,GAAT,SAAS,CAAW;QACnB,gBAAW,GAAX,WAAW,CAAoB;QAC/B,cAAS,GAAT,SAAS,CAAiB;QAC3B,cAAS,GAAT,SAAS,CAAiB;QAC1B,SAAI,GAAJ,IAAI,CAAgB;QACpB,SAAI,GAAJ,IAAI,CAAY;QAEvB,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAChC,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,kEAAU,CAAC,QAAQ,CAAC,CAAC;QACjD,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,kEAAU,CAAC,QAAQ,CAAC,CAAC;QAClD,mDAAmD;QACnD,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,KAAK,CAAC;YACzB,OAAO,EAAE,IAAI,CAAC,KAAK;YACnB,QAAQ,EAAE,IAAI,CAAC,MAAM;SAEtB,CAAC;IACJ,CAAC;IAED,oCAAc,GAAd;QACE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAC1B,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IAC5B,CAAC;IAED,iCAAW,GAAX;QAAA,iBAcC;QAbC,IAAM,MAAM,GAAgB;YAC1B,OAAO,EAAE,EAAE;YACX,eAAe,EAAE,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ;YACrD,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,MAAM;YAChD,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI;SAC5C;QAED,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAC,SAAS;YAC1C,KAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;YAC1B,KAAI,CAAC,aAAa,GAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;QACtE,CAAC,EAAE,UAAC,GAAG;YACL,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC;IACP,CAAC;IAED,4BAAM,GAAN;QAAA,iBAoDC;QAnDC,IAAI,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAC,OAAO,EAAE,qBAAqB,EAAC,CAAC,CAAC;QACvE,IAAI,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC;QACpD,IAAI,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC;QACtD,sDAAsD;QACtD,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;QACvB,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;QACvB,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC;QAE/B,IAAI,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;YACxB,KAAK,EAAC,GAAG;YACT,KAAK,EAAC,GAAG;YACT,OAAO,EAAC,KAAK;YACb,QAAQ,EAAC,MAAM;YACf,gBAAgB;YAChB,OAAO,EAAC,KAAK;SACd,CAAC,CAAC;QAEH,MAAM,CAAC,OAAO,EAAE,CAAC;QACjB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,gDAAgD,EAAE,IAAI,CAAC;aACrE,SAAS,CAAC,aAAG;YACZ,MAAM,CAAC,OAAO,EAAE,CAAC;QACnB,CAAC,EAAE,eAAK;YACN,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YACvB,MAAM,CAAC,OAAO,EAAE,CAAC;QACnB,CAAC,CAAC,CAAC;QAEH,cAAc;QACd,IAAM,YAAY,GAAuB,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;QAChE,IAAI,OAAO,GAAsB;YAC/B,OAAO,EAAE,MAAM;YACf,QAAQ,EAAE,IAAI,CAAC,aAAa;YAC5B,WAAW,EAAE,KAAK;YAClB,QAAQ,EAAE,YAAY;YACtB,OAAO,EAAE,EAAE;SACZ;QAED,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,gDAAgD,EAAE,OAAO,CAAC;aAC5F,IAAI,CAAC,aAAG;YACP,MAAM,CAAC,OAAO,EAAE,CAAC;YACjB,KAAI,CAAC,UAAU,EAAE,CAAC;YAClB,IAAI,KAAK,GAAC,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC9B,KAAK,EAAE,kBAAkB;gBACzB,QAAQ,EAAE,4CAA4C;gBACtD,OAAO,EAAC,CAAC,IAAI,CAAC;aACf,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;YAChB,mDAAmD;QACrD,CAAC,EAAE,UAAC,GAAG;YACL,MAAM,CAAC,OAAO,EAAE,CAAC;YACjB,KAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;QACzB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,kCAAY,GAAZ,UAAa,GAAG;QACZ,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAChC,OAAO,EAAE,GAAG;YACZ,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,QAAQ;SACnB,CAAC,CAAC;QACH,KAAK,CAAC,YAAY,CAAC;YACjB,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QACH,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED,gCAAU,GAAV;QACE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;QACpB,yCAAyC;IAC3C,CAAC;IA1HU,WAAW;QAJvB,wEAAS,CAAC;YACT,QAAQ,EAAE,eAAe;WACG;SAC7B,CAAC;gFAYgC;YAClB,qEAAW;YACN,gEAAM;YACL,wEAAS;YACL,uEAAiB;YACpB,sEAAe;YAChB,sEAAe;YACpB,0EAAc;YACd,QAAU;OAnBd,WAAW,CA4HvB;IAAD,CAAC;AAAA;SA5HY,WAAW,gB","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { AddDataPage } from './add-data';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddDataPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(AddDataPage),\r\n  ],\r\n})\r\nexport class AddDataPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-data/add-data.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavParams, ViewController, LoadingController, ToastController, AlertController } from 'ionic-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Camera, CameraOptions } from '@ionic-native/camera';\r\nimport { FormBuilder, FormGroup, FormControl, Validators } from '@angular/forms';\r\nimport { FileTransfer, FileUploadOptions, FileTransferObject } from '@ionic-native/file-transfer';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-add-data',\r\n  templateUrl: 'add-data.html',\r\n})\r\nexport class AddDataPage {\r\n  public pos: any;\r\n\r\n  public reportForm : FormGroup;\r\n  public title : FormControl;\r\n  public descpt : FormControl;\r\n  //public fname : FormControl;\r\n  public imageURI:any;\r\n  public imageFileName:any;\r\n\r\n  constructor(\r\n    private transfer: FileTransfer,\r\n    public fb : FormBuilder,  \r\n    private camera : Camera, \r\n    public navParams: NavParams, \r\n    private loadingCtrl : LoadingController,\r\n    private alertCtrl: AlertController,\r\n    public toastCtrl: ToastController,\r\n    public view: ViewController,\r\n    public http: HttpClient\r\n  ) {\r\n    this.pos = navParams.get('pos');\r\n    this.title = fb.control('', Validators.required);\r\n    this.descpt = fb.control('', Validators.required);\r\n    //this.fname = fb.control('', Validators.required);\r\n    this.reportForm = fb.group({\r\n      'title': this.title, \r\n      'descpt': this.descpt, \r\n      //'fname': this.fname\r\n    })\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log(this.pos.lat);\r\n    console.log(this.pos.lng);\r\n  }\r\n\r\n  takePicture() {\r\n    const imgCam: CameraOptions={\r\n      quality: 50,\r\n      destinationType: this.camera.DestinationType.FILE_URI,\r\n      sourceType: this.camera.PictureSourceType.CAMERA,\r\n      encodingType: this.camera.EncodingType.JPEG\r\n    }\r\n    \r\n    this.camera.getPicture(imgCam).then((imageData) => {\r\n        this.imageURI = imageData;\r\n        this.imageFileName=imageData.substr(imageData.lastIndexOf('/') + 1);\r\n      }, (err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  submit() {\r\n    let loader = this.loadingCtrl.create({content: \"กำลังบันทึกข้อมูล..\"});    \r\n    let title = this.reportForm.controls['title'].value;\r\n    let descpt = this.reportForm.controls['descpt'].value;\r\n    //let fname = this.reportForm.controls['fname'].value;\r\n    let lat = this.pos.lat;\r\n    let lon = this.pos.lng;\r\n    let img64 = this.imageFileName;\r\n   \r\n    let data = JSON.stringify({\r\n      'lat':lat,\r\n      'lon':lon,\r\n      'title':title,\r\n      'descpt':descpt,\r\n      //'fname':fname,\r\n      'img64':img64\r\n    });\r\n    \r\n    loader.present();    \r\n    this.http.post('http://119.59.125.189/service/isnre_report.php', data)\r\n    .subscribe(res => {\r\n      loader.dismiss();\r\n    }, error => {\r\n      console.log(\"Oooops!\");\r\n      loader.dismiss();\r\n    });\r\n\r\n    //upload image\r\n    const fileTransfer: FileTransferObject = this.transfer.create();\r\n    let options: FileUploadOptions = {\r\n      fileKey: 'file',\r\n      fileName: this.imageFileName,      \r\n      chunkedMode: false,\r\n      mimeType: \"image/jpeg\",\r\n      headers: {}\r\n    }\r\n  \r\n    fileTransfer.upload(this.imageURI, 'http://119.59.125.189/service/isnre_upload.php', options)\r\n    .then(res => {   \r\n      loader.dismiss(); \r\n      this.closeModal();      \r\n      let alert=this.alertCtrl.create({\r\n        title: 'ส่งข้อมูลสำเร็จ!',\r\n        subTitle: 'ข้อมูลของคุณถูกส่งเข้าสู่ระบบเรียบร้อยแล้ว',\r\n        buttons:['ok']\r\n      });\r\n      alert.present();     \r\n      //this.presentToast(\"Image uploaded successfully\");\r\n    }, (err) => {\r\n      loader.dismiss();\r\n      this.presentToast(err);\r\n    });\r\n  }  \r\n  \r\n  presentToast(msg) {\r\n      let toast = this.toastCtrl.create({\r\n        message: msg,\r\n        duration: 6000,\r\n        position: 'bottom'\r\n      });  \r\n      toast.onDidDismiss(() => {\r\n        console.log('Dismissed toast');\r\n      });  \r\n      toast.present();\r\n  } \r\n  \r\n  closeModal() {\r\n    this.view.dismiss();\r\n    //this.navCtrl.setRoot(MapPage, this.dat)\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-data/add-data.ts"],"sourceRoot":""}